#基于multiType的云之家组织架构重构#
##前言##
**1重构的意义何在？**  
云之家组织架构模块，意在为云之家组织和人员提供最基础的服务，包括：浏览当前团队组织结构、选人和组织架构设置相关工作。在今年的产品需求规划中，随着云之家关注模型的建立，部分产品逻辑也是跟组织架构模块息息相关，所以，这就要求组织架构必须具备以下几点：1 稳定，各业务线调用组织架构时，不能出现数据与预期不符合，甚至闪退的情况；2 灵活，组织架构必须是灵活的，可根据企业的不同需求，展示不同风格的页面；3 可拓展，随着云之家的快速发展，业务功能随时都可能调整，这次重构必须为以后可能存在的大幅度改动做好准备。  
**2现有的组织架构存在什么问题？**  
1 架构设计问题：原有组织架构代码，所有的业务逻辑都写在了一个Activity中，导致这个activity及其庞大且不好维护，每当新加一个功能或者改动一处老地方时，需要回归所有相关的业务，造成资源的大量浪费  
2 性能问题：因为组织架构有一项需求，就是支持拖动排序部门。为了实现这个功能，我们引入了一个第三方的开源框架（DragSortListView），这个listview组件有两个问题，第一个是在具有压力感应的手机上面，无法长按拖动排序，导致我们为了兼容这个问题，改变了交换方式；第二：页面刷新存在问题，在一些复杂的组织架构下，会出现绘制异常，导致listview会出现一个空白的item
综合上面的原因，为了应对云之家产品的蓬勃发展，组织架构重构重构工作迫在眉睫
##方案##
###模块拆分###
本次重构，最核心的思想就是解耦，尽可能的把组织架构现有的业务和功能进行拆分，然后再根据业务需要，自由的拼接在一起，在这个思想上，我们对组织架构进行了一下几大模块的拆分：  
1 浏览模式组织架构  
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/organsturct1.png?raw=true" width = "200" height = "320" alt="图片名称"  />
2 组织架构设置模式
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/organstruct3.png?raw=true" width = "200" height = "320" alt="图片名称" />
3 组织架构选人模式
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/organstruct2.jpg?raw=true" width = "200" height = "320" alt="图片名称" />  
根据上面的组织架构展示样式，我们把组织架构所有的功能点进行拆分，得出以下几大功能点：  
1 组织信息展示栏
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E9%A1%B6%E5%B1%82%E4%BF%A1%E6%81%AF.png?raw=true" width = "598" height = "302" alt="图片名称" />
2 部门成员信息模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E9%83%A8%E9%97%A8%E6%88%90%E5%91%98%E6%A8%A1%E5%9D%97.png?raw=true" width = "598" height = "184" alt="图片名称" />
3 部门负责人信息模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E8%B4%9F%E8%B4%A3%E4%BA%BA%E6%A8%A1%E5%9D%97.png?raw=true" width = "598" height = "160" alt="图片名称" />
4 下级部门信息模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E4%B8%8B%E7%BA%A7%E9%83%A8%E9%97%A8%E6%A8%A1%E5%9D%97.png?raw=true" width = "598" height = "142" alt="图片名称" />
5 分隔栏模块（用于各个模块之间进行区分）
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E5%88%86%E9%9A%94%E6%A0%8F.png?raw=true" width = "598" height = "58" alt="图片名称" />
6 查看更多模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E6%9F%A5%E7%9C%8B%E6%9B%B4%E5%A4%9A.png?raw=true" width = "484" height = "58" alt="图片名称" />
7 部门面包屑展示模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E9%9D%A2%E5%8C%85%E5%B1%91%E6%A8%A1%E5%9D%97.png?raw=true" width = "594" height = "68" alt="图片名称" />
8 选人模式下，部门成员展示模块
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E9%80%89%E4%BA%BA%E6%A8%A1%E5%BC%8F%E4%B8%8B%E9%83%A8%E9%97%A8%E6%88%90%E5%91%98%E6%A8%A1%E5%9D%97.png?raw=true" width = "594" height = "280" alt="图片名称" />
9 底部部门设置操作栏
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E5%BA%95%E9%83%A8%E6%93%8D%E4%BD%9C%E6%A0%8F.png?raw=true" width = "598" height = "76" alt="图片名称" />
10 人员底部选择栏
<img src="https://github.com/gdutkyle/commonPicture/blob/master/organstruct/%E7%BB%84%E7%BB%87%E6%9E%B6%E6%9E%84%E4%BA%BA%E5%91%98%E9%80%89%E6%8B%A9%E5%BA%95%E9%83%A8%E6%A0%8F.png?raw=true" width = "598" height = "82" alt="图片名称" />
